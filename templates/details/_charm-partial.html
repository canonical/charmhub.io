{% set icon_obj = charm.media | selectattr("type", "eq", "icon") %}

<a
  class="p-media-object"
  href="/{{ charm.name }}"
  title="{{ charm.title or charm.name }}{% if charm.summary %} – {{ charm.summary }}{% endif %}"
  >
  {% set icon_url = "https://assets.ubuntu.com/v1/be6eb412-snapcraft-missing-icon.svg" %}
  {% set size = 60 %}
  {% if icon_obj and icon_obj.url %}
    {% set icon_url = icon_obj.icon_url %}
  {% endif %}

  {{
    image(
      url=icon_url,
      alt=charm.title or charm.name,
      width=size,
      height=size,
      hi_def=True,
      attrs={"class": "p-media-object__image"}
    ) | safe
  }}

  <div class="p-media-object__details u-overflow-visible" style="width: calc(100% - 48px);">
    <h4 class="p-media-object__title p-heading--5 u-no-margin--bottom">
      {{ charm.title or charm.name }}
    </h4>
    <div class="p-media-object__content">
      {% if charm.summary %}
        <p>{{ charm.summary }}</p>
      {% endif %}
    </div>
  </div>
</a>
