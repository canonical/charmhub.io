<div>
  <div class="p-section--shallow u-no-padding--top">
    <h4 style="font-weight: 500">{{ solution.name }}</h4>
    {{ solution.long_description_html | safe }}
  </div>

  {% if solution.use_cases %}
    <hr class="p-separator--shallow">
    <div class="p-section--shallow u-no-padding--top">
      <h4 style="font-weight: 500">Use cases</h4>
      <div class="row">
        {% for use_case in solution.use_cases %}
          {% for title, description in use_case.items() %}
            <div class="col-3">
              <hr class="p-rule--highlight">
              <h5>{{ title }}</h5>
              <p>{{ description }}</p>
            </div>
          {% endfor %}
        {% endfor %}
      </div>
    </div>
  {% endif %}

  {% if solution.documentation.architecture_diagram %}
    <hr class="p-separator--shallow">
    <div class="p-section--shallow u-no-padding--top">
      <h4 style="font-weight: 500">Architecture</h4>
      <img src="{{ solution.documentation.architecture_diagram }}" alt="canonical observability architecture diagram" loading="lazy">
    </div>
  {% endif %}

  {% if solution.charms %}
    <hr class="p-separator--shallow">
    <div class="p-section--shallow u-no-padding--top">
      <h4 style="font-weight: 500">Charms</h4>
      <div class="row--50-50" id="charm-card-list">
        {% for charm in solution.charms %}
        <div class="col u-equal-height charm-card-details" style="{% if loop.index > 4 %}display: none;{% endif %}">
          {% include '/solutions/_solution_charm_card.html' %}
        </div>
        {% endfor %}
      </div>
      {% if solution.charms | length > 4 %}
        <button id="load-more-charm-details" class="p-button">
          <span class="button-text">See all ({{ solution.charms | length }})</span>
          <i class="p-icon--spinner u-animation--spin" style="display: none;"></i>
        </button>
      {% endif %}
    </div>
  {% endif %}

  {% if solution.links %}
    <hr class="p-separator--shallow">
    <div class="p-section--shallow u-no-padding--top">
      <div class="row">
        <div class="col-3">
          <h4 style="font-weight: 500">Useful links</h4>
        </div>
        <div class="col-3">
        </div>
        <div class="col-3">
          <div>
            <a href="{{ solution.source }}">Get started&nbsp;&rsaquo;</a>
          </div>
          <div>
            <a href="{{ solution.submit_bug }}">Submit a bug&nbsp;&rsaquo;</a>
          </div>
          <div>
            <a href="{{ solution.join_dicsussion }}">Join the discussion&nbsp;&rsaquo;</a>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const loadMoreButton = document.getElementById('load-more-charm-details');
    if (loadMoreButton) {
      const buttonText = loadMoreButton.querySelector('.button-text');
      const spinner = loadMoreButton.querySelector('.p-icon--spinner');

      loadMoreButton.addEventListener('click', () => {
        buttonText.style.display = 'none';
        spinner.style.display = 'inline-block';

        setTimeout(() => {
          const hiddenCharms = document.querySelectorAll('.charm-card-details[style*="display: none"]');
          hiddenCharms.forEach(charm => {
            charm.style.display = 'block';
          });
          loadMoreButton.style.display = 'none';
        }, 500);
      });
    }
  });
</script>